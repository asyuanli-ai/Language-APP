<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€£ç·šæ¸¬è©¦ - LingoFlow</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white p-6 flex flex-col h-screen">
    <h1 class="text-xl font-bold mb-4 text-blue-400">Gemini é€£ç·šæ¸¬è©¦</h1>
    
    <div class="mb-4 space-y-2">
        <label class="block text-xs text-slate-400">è«‹è²¼ä¸Š API é‡‘é‘° (AIza é–‹é ­):</label>
        <input type="password" id="key-input" class="w-full p-3 bg-slate-800 rounded-lg border border-slate-700 outline-none text-blue-300">
        <button onclick="testConnection()" id="test-btn" class="w-full bg-blue-600 py-3 rounded-lg font-bold hover:bg-blue-500 transition-all">æ¸¬è©¦é€£ç·š</button>
    </div>

    <div id="result-box" class="flex-1 bg-black rounded-lg p-4 font-mono text-sm overflow-y-auto border border-slate-800">
        <div class="text-slate-500 italic">ç³»çµ±æº–å‚™å°±ç·’ï¼Œè«‹é»æ“Šæ¸¬è©¦é€£ç·š...</div>
    </div>

    <script>
        // é é¢è¼‰å…¥æ™‚è®€å–èˆŠçš„ Key (å¦‚æœæœ‰)
        document.getElementById('key-input').value = localStorage.getItem('test_key') || '';

        async function testConnection() {
            const key = document.getElementById('key-input').value.trim();
            const btn = document.getElementById('test-btn');
            const box = document.getElementById('result-box');
            
            if(!key) return alert('è«‹è¼¸å…¥é‡‘é‘°');
            localStorage.setItem('test_key', key);
            
            box.innerHTML = '<div class="text-yellow-400 font-bold">æ­£åœ¨ç™¼é€è«‹æ±‚è‡³ Google ä¼ºæœå™¨...</div>';
            btn.disabled = true;
            btn.innerText = 'é€£ç·šä¸­...';

            // ğŸ’¡ 2026 å¹´æœ€ç©©å®šçš„ API è·¯å¾‘
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${key}`;

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: "Hello! If you can read this, please reply 'Connected successfully'." }] }]
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    const aiReply = data.candidates[0].content.parts[0].text;
                    box.innerHTML = `
                        <div class="text-green-400 font-bold mb-2">âœ… é€£ç·šæˆåŠŸï¼</div>
                        <div class="p-3 bg-slate-800 rounded border border-green-900/50 text-white">${aiReply}</div>
                        <div class="mt-4 text-xs text-slate-500 italic">é€™ä»£è¡¨ä½ çš„ API é€šè·¯å·²æ‰“é€šã€‚</div>
                    `;
                } else {
                    // é¡¯ç¤ºè©³ç´°å ±éŒ¯ï¼Œè®“æˆ‘å€‘çŸ¥é“ç‚ºä»€éº¼ Google å™´ 404
                    box.innerHTML = `
                        <div class="text-red-500 font-bold mb-2">âŒ é€£ç·šå¤±æ•— (ç‹€æ…‹ç¢¼: ${response.status})</div>
                        <div class="p-3 bg-red-950/30 rounded border border-red-900 text-red-300">
                            éŒ¯èª¤è¨Šæ¯: ${data.error?.message || 'ç„¡è©³ç´°è¨Šæ¯'}<br><br>
                            éŒ¯èª¤ä»£ç¢¼: ${data.error?.status || 'UNKNOWN'}
                        </div>
                        <div class="mt-4 text-xs text-slate-400">
                            å¦‚æœä¾ç„¶æ˜¯ 404ï¼Œä»£è¡¨ Google å°ˆæ¡ˆæœªåŒæ­¥ï¼Œè«‹å˜—è©¦ã€Œä¸é™åˆ¶é‡‘é‘°ã€è¨­å®šã€‚
                        </div>
                    `;
                }
            } catch (e) {
                box.innerHTML = `<div class="text-red-500">ç¶²è·¯è«‹æ±‚ç•°å¸¸: ${e.message}</div>`;
            } finally {
                btn.disabled = false;
                btn.innerText = 'æ¸¬è©¦é€£ç·š';
            }
        }
    </script>
</body>
</html>